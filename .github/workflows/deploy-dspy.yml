##
# FILE PURPOSE: Post-deploy verification for DSPy optimizer on Railway
#
# WHY: Railway auto-deploys from git push to main (git-based deploy).
#      This workflow verifies the DSPy service built successfully.
# HOW: On push to main (dspy path), waits for Railway build to complete.
#      DSPy is a one-shot worker — no persistent health endpoint.
#
# AUTHOR: Claude Opus 4.6
# LAST UPDATED: 2026-03-02
##

name: Deploy DSPy

on:
  workflow_dispatch:
  push:
    branches: [main]
    paths:
      - 'services/dspy/**'

concurrency:
  group: deploy-dspy-${{ github.ref }}
  cancel-in-progress: true

jobs:
  post-deploy-check:
    runs-on: ubuntu-latest
    environment: production
    steps:
      - name: Railway auto-deploy notice
        run: |
          echo "Railway auto-deploys DSPy from git push to main."
          echo "DSPy is a one-shot worker — no persistent health endpoint to check."
          echo "Verify via Railway dashboard logs if needed."
